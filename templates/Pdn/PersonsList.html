{% extends 'base.html' %}
{% load modified %}
{% load static %}

{% block title %}Список сотрудников и студентов | ПГУ им. "Шолом-Алейхема"{% endblock %}

{% block content %}
    <div class="ui container">
        <div class="child-center">
            <div class="skzi-list cblock">
                <div class="content">
                    <h1 class="ui center aligned header">Сотрудники и студенты</h1>
                    <div class="panel">
                        <div class="buttons left">
                            <a href="{% iurl 'pdn:person_form' %}"
                               class="button primary ui medium">Добавить нового</a>
                        </div>
                    </div>
                    <div class="sixteen wide table-container">
                        <div class="table-width">
                            <table class="ui celled selectable sortable table tableFixHead">
                                <thead>
                                <tr>
                                    <th>#</th>
                                    <th>ФИО</th>
                                    <th>Дата рождения</th>
                                    <th>Факультет, подразделение</th>
                                    <th>Согласие на обработку персональных данных</th>
                                    <th>Согласие на распространение персональных данных</th>
                                </tr>
                                </thead>
                                <tbody>
                                {% for instance in instances %}
                                    <tr data-id="{{ instance.id }}">
                                    <td data-label="#">{{ instances|length|substract:forloop.counter0 }}</td>
                                    <td data-label="ФИО">{{ instance.get_fio }}</td>
                                    <td data-label="Дата рождения">{{ instance.birth_date }}</td>
                                    <td data-label="Факультет, подразделение">{{ instance.fakultet|default_if_none:'' }} {{ instance.podrazd|default_if_none:'' }}</td>
                                    <td style="white-space: normal" data-label="Согласие на обработку персональных данных">
                                        <div class="ui {% if instance.soglasie %} checked {% endif %} checkbox">
                                            <input type="checkbox" {% if instance.soglasie %} checked {% endif %} class="hidden" readonly="" tabindex="0"/>
                                        </div>
                                    </td>
                                    <td style="white-space: normal" data-label="Согласие на распространение персональных данных">
                                        <div class="ui {% if instance.sogl_raspr %} checked {% endif %} checkbox">
                                            <input type="checkbox" {% if instance.sogl_raspr %} checked {% endif %} class="hidden" readonly="" tabindex="0"/>
                                        </div>
                                    </td>
                                {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}
{% block script %}
    <script type="text/javascript" src="{% static 'js/table_sort.js' %}"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            $('.button:not(.download)').click(function () {
                $(this).addClass('loading')
            });
            $('tbody tr').click(function () {
                var id = $(this).attr('data-id')
                window.location.href = '{% url 'pdn:person_form' %}' + id + '/'
            })
            $('.ui.checkbox').checkbox()
            $('table').tablesort()
        })
    </script>
{% endblock %}